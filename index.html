<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Team Performance Dashboard</title>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        body {
            background-color: #f0f8ff;
            color: #333;
        }
        .container {
            background-color: white;
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 0 10px rgba(0,0,0,0.1);
        }
        h1, h2, h3 {
            color: #4682b4;
        }
        .btn-primary {
            background-color: #4682b4;
            border-color: #4682b4;
        }
        .btn-primary:hover {
            background-color: #36648b;
            border-color: #36648b;
        }
        .table-hover tbody tr:hover {
            background-color: #e6f2ff;
        }
    </style>
</head>
<body>
<div class="container mt-5">
    <h1 class="text-center">Welcome to Training Culture</h1>
    <p class="text-center">Your journey to optimal team performance starts here!</p>

    <!-- Rest of the HTML remains the same -->

    <div class="row mt-4">
        <div class="col-md-6">
            <canvas id="talentChart"></canvas>
        </div>
        <div class="col-md-6">
            <canvas id="roleChart"></canvas>
        </div>
    </div>

    <!-- Rest of the HTML remains the same -->

</div>

<script>
    let team = {};
    let members = [];
    let memberTasks = {};

    // Rest of the JavaScript remains the same until updateChart function

    function updateChart() {
        updateTalentChart();
        updateRoleChart();
    }

    function updateTalentChart() {
        const ctx = document.getElementById('talentChart').getContext('2d');
        const data = {
            labels: members.map(member => member.name),
            datasets: [
                {
                    label: 'Talent Rating',
                    data: members.map(member => {
                        switch (member.talent) {
                            case 'Critical': return 5;
                            case 'High': return 4;
                            case 'Moderate': return 3;
                            case 'Low': return 2;
                            case 'Emerging': return 1;
                            default: return 0;
                        }
                    }),
                    backgroundColor: 'rgba(54, 162, 235, 0.5)',
                    borderColor: 'rgba(54, 162, 235, 1)',
                    borderWidth: 1
                },
                {
                    label: 'Task Performance',
                    data: members.map(member => {
                        const tasks = memberTasks[member.name];
                        if (tasks && tasks.length > 0) {
                            const weightedSum = tasks.reduce((sum, task) => {
                                const importanceWeight = task.importance === 'High' ? 3 : task.importance === 'Medium' ? 2 : 1;
                                const qualityWeight = task.timeQuality === 'Excellent' ? 4 : task.timeQuality === 'Good' ? 3 : task.timeQuality === 'Fair' ? 2 : 1;
                                return sum + (importanceWeight * qualityWeight);
                            }, 0);
                            return (weightedSum / (tasks.length * 12)) * 10; // Normalize to 0-10 scale
                        }
                        return 0;
                    }),
                    backgroundColor: 'rgba(75, 192, 192, 0.5)',
                    borderColor: 'rgba(75, 192, 192, 1)',
                    borderWidth: 1
                }
            ]
        };

        if (window.talentChartInstance) {
            window.talentChartInstance.destroy();
        }

        window.talentChartInstance = new Chart(ctx, {
            type: 'bar',
            data,
            options: {
                scales: {
                    y: {
                        beginAtZero: true,
                        max: 10
                    }
                }
            }
        });
    }

    function updateRoleChart() {
        const ctx = document.getElementById('roleChart').getContext('2d');
        const roleCounts = members.reduce((counts, member) => {
            counts[member.role] = (counts[member.role] || 0) + 1;
            return counts;
        }, {});

        const data = {
            labels: Object.keys(roleCounts),
            datasets: [{
                data: Object.values(roleCounts),
                backgroundColor: [
                    'rgba(255, 99, 132, 0.8)',
                    'rgba(54, 162, 235, 0.8)',
                    'rgba(255, 206, 86, 0.8)',
                    'rgba(75, 192, 192, 0.8)',
                    'rgba(153, 102, 255, 0.8)',
                ]
            }]
        };

        if (window.roleChartInstance) {
            window.roleChartInstance.destroy();
        }

        window.roleChartInstance = new Chart(ctx, {
            type: 'pie',
            data,
            options: {
                responsive: true,
                plugins: {
                    legend: {
                        position: 'top',
                    },
                    title: {
                        display: true,
                        text: 'Team Roles Distribution'
                    }
                }
            }
        });
    }

    // Add this function to allow updating existing members
    function updateMember(name) {
        const member = members.find(m => m.name === name);
        if (member) {
            member.role = prompt("Enter new role:", member.role) || member.role;
            member.talent = prompt("Enter new talent (Critical/High/Moderate/Low/Emerging):", member.talent) || member.talent;
            updateMembersTable();
            updateChart();
        }
    }

    // Modify the updateMembersTable function to include an update button
    function updateMembersTable() {
        const table = document.getElementById('membersTable');
        table.innerHTML = '';
        members.forEach(member => {
            const row = document.createElement('tr');
            row.innerHTML = `
                <td>${member.name}</td>
                <td>${member.role}</td>
                <td>${member.talent}</td>
                <td>
                    <button class="btn btn-info btn-sm mr-2" onclick="updateMember('${member.name}')">Update</button>
                    <button class="btn btn-danger btn-sm" onclick="deleteMember('${member.name}')">Delete</button>
                </td>
            `;
            row.addEventListener('click', () => {
                document.getElementById('taskMemberName').textContent = member.name;
                document.getElementById('taskMemberNameDisplay').textContent = member.name;
                updateTasksTable(member.name);
            });
            table.appendChild(row);
        });
    }

    // Rest of the JavaScript remains the same
</script>
</body>
</html>
